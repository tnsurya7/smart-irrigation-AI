/* 
 * MOBILE-ONLY FIX FOR IPHONE 15 CARD OVERLAPPING
 * Safe fix that doesn't affect desktop layout
 */

/* MOBILE FIX ONLY - Prevent card overlapping */
@media (max-width: 768px) {
  /* Ensure all dashboard cards stack naturally */
  .dashboard-card,
  [class*="bg-slate-800"],
  [class*="rounded-2xl"] {
    position: relative !important;
    height: auto !important;
    min-height: auto !important;
    overflow: visible !important;
  }

  /* Fix parent containers to expand properly */
  .dashboard-section,
  main > div {
    display: flex;
    flex-direction: column;
    gap: 1.5rem; /* 24px - same as existing gap-6 */
  }

  /* Ensure grid containers work properly on mobile */
  .grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 1.5rem !important;
  }

  /* Fix specific card heights that might cause overlap */
  .card-glow,
  [class*="h-[220px]"] {
    height: auto !important;
    min-height: 200px;
    padding: 1.5rem;
  }

  /* Prevent absolute positioning issues */
  .mobile-no-absolute {
    position: relative !important;
  }

  /* Fix any fixed heights in forecast/control cards */
  .retraining-card,
  [class*="ForecastCard"],
  [class*="ControlCard"] {
    height: auto !important;
    white-space: normal !important;
    overflow: visible !important;
  }

  /* Ensure proper spacing between major sections */
  main > .grid,
  main > div {
    margin-bottom: 2rem !important;
  }

  /* Fix weather panel and historical explorer */
  [class*="WeatherPanel"],
  [class*="HistoricalTrendExplorer"] {
    height: auto !important;
    min-height: auto !important;
  }

  /* Ensure chat button doesn't interfere */
  .fixed.bottom-4.right-4 {
    z-index: 50 !important;
  }

  /* ===== HISTORICAL TREND EXPLORER CONTAINMENT FIX ===== */
  /* Force Historical Card to contain all children */
  .historical-card {
    position: relative !important;
    overflow: visible !important; /* Allow content to be visible but contained */
    contain: layout !important; /* CSS containment for better layout control */
  }

  /* Force metric buttons row to stay inside card flow */
  .metric-row,
  .flex.flex-wrap.gap-6,
  .flex.gap-2 {
    position: relative !important;
    width: 100% !important;
    display: flex !important;
    flex-wrap: wrap !important;
    margin-bottom: 1rem !important;
  }

  /* Fix any absolute positioned elements in Historical Trend Explorer */
  .historical-card .absolute,
  [class*="HistoricalTrendExplorer"] .absolute {
    position: static !important;
  }

  /* Ensure control buttons stay contained */
  .historical-card button,
  [class*="HistoricalTrendExplorer"] button {
    position: relative !important;
    flex-shrink: 0;
  }

  /* Fix flex containers that might escape */
  .historical-card > div,
  [class*="HistoricalTrendExplorer"] > div {
    position: relative !important;
    width: 100% !important;
  }
}

/* iPhone 15 specific fixes */
@media (max-width: 430px) and (-webkit-device-pixel-ratio: 3) {
  /* Extra safety for iPhone 15 */
  body {
    overflow-x: hidden;
  }
  
  main {
    padding: 0.75rem !important;
  }
  
  .grid {
    gap: 1rem !important;
  }

  /* iPhone 15 specific - force metric buttons to wrap properly */
  .metric-row,
  .flex.gap-2 {
    gap: 0.5rem !important;
  }

  /* Ensure buttons don't overflow on small screens */
  .historical-card button,
  [class*="HistoricalTrendExplorer"] button {
    font-size: 0.875rem !important;
    padding: 0.5rem 0.75rem !important;
  }
}